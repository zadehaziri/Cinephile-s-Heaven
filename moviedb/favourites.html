<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home | Cinephile's Heaven</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link rel="stylesheet" href="./assets/css/style.css">
</head>

<body>
    <header></header>

    <section id="movies" class="py-5">
        <div class="container">
        </div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
        crossorigin="anonymous"></script>
    <script src="./node_modules/axios/dist/axios.min.js"></script>
    <script src="./assets/js/dynamicListener.min.js"></script>
    <script type="module">
        import { Header } from './components/Header.js'
        import { Movies } from './components/Movies.js'

        // display header
        document.querySelector('header').innerHTML = Header()

        // display favourite movies
        const favourites = localStorage.getItem('favourites')

        if (favourites === null)
            document.querySelector('#movies > div').innerHTML = 'Your favourites list is empty.'
        else
            document.querySelector('#movies > div').innerHTML = Movies(JSON.parse(favourites))

        // delete movie from favourites
        addDynamicEventListener(document.body, 'click', 'div.actions > button', function (e) {
            const element = (e.target.tagName.toLowerCase() === 'i') ? e.target.parentElement : e.target
            const movie_id = element.getAttribute('movie-id')

            if (favourites !== null) {
                const movies = JSON.parse(favourites).filter(movie => movie.id != movie_id)
                localStorage.setItem('favourites', JSON.stringify(movies))
                document.querySelector('#movies > div').innerHTML = Movies(movies)
            }
        })
    </script>
</body>

</html>